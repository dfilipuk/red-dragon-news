<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{{ asset('public/bootstrap/css/bootstrap.min.css') }}" >
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.red-indigo.min.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="{{ asset('public/css/style.css') }}">
    <link rel="icon" href="{{ asset('public/img/logo_tab.png') }}">
    <title>{% block title %}{% endblock %}</title>
</head>
<body>
<div class="layout-transparent mdl-layout mdl-js-layout wrapper">
    <header class="mdl-layout__header mdl-layout__header--transparent">
        <div class="mdl-layout__header-row">
            {% if app.user.isSubscribe == 1 %}
                <button class="button-right-margin mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" id="unsubscribe" type="button">Unsubscribe</button>
            {% else %}
                <button class="button-right-margin mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" id="show-dialog" type="button">Subscribe</button>
            {% endif %}
            <div class="mdl-layout-spacer"></div>
            <nav class="mdl-navigation">
                <div class="avatar-dropdown">
                    <span class="mdl-layout-title ">{{ app.user.email }}</span>
                    <button id="accbtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
                        <i class="material-icons" role="presentation">arrow_drop_down</i>
                        <span class="visuallyhidden">Accounts</span>
                    </button>
                    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="accbtn">
                        {% if is_granted('ROLE_MANAGER') %}
                            <a class="news-href" href="{{ path('admin-home') }}"><li class="mdl-menu__item">Admin panel</li></a>
                        {% endif %}
                        <a class="news-href" href="{{ path('sign_out') }}" ><li class="mdl-menu__item" >Logout</li></a>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <div class="mdl-layout-title"><a href="{{ path('category', {'category': 'all-categories'}) }}" class="news-href">All categories</a></div>
        <nav class="mdl-navigation">
            {% for category in categories %}
                <a class="mdl-navigation__link news-href" href="{{ path('category', {'category': category.name}) }}">{{ category.name|sliceAdvanced(40) }}</a>
            {% endfor %}
        </nav>
    </div>
    <main class="mdl-layout__content">
        <div class="container-fluid main-container">
            <div class="row">
                <div class="col-sm-8 col-sm-offset-2">
                    <div class="layout-background-logo mdl-card mdl-shadow--2dp">
                        <div class="row">
                            <div class="col-sm-4 text-center">
                                <a href="{{ path("homepage") }}"><img src="{{ asset('public/img/logo.png') }}" class="logo"></a>
                            </div>
                            <div class="col-sm-4 margin-top-15">
                                <form class="search-input" action="{{ path('search') }}" method="get">
                                    <input type="text" name="search">
                                    <span class="highlight"></span>
                                    <span class="bar"></span>
                                    <label>Search something...</label>
                                    <span class="glyphicon glyphicon-search"></span>
                                    <span class="glyphicon glyphicon-remove"></span>
                                </form>
                            </div>
                            <div class="col-sm-2 col-sm-offset-1 margin-top-15">
                                <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                                    <select id="sorting" name="sorting" onchange="onSelectChange()" class="mdl-textfield__input">
                                        <option {{ 'selected'|styleSelector(isAscending, isOrderByDate) }}>Date &uarr;</option>
                                        <option {{ 'selected'|styleSelector(not isAscending, isOrderByDate) }}>Date &darr;</option>
                                        <option {{ 'selected'|styleSelector(isAscending, not isOrderByDate) }}>Views count &uarr;</option>
                                        <option {{ 'selected'|styleSelector(not isAscending, not isOrderByDate) }}>Views count &darr;</option>
                                    </select>
                                    <label class="mdl-textfield__label" for="sorting">Sort by</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="general-container">
                {% block body %}{% endblock %}
            </div>

        </div>
    </main>
    <dialog class="mdl-dialog">
        <h4 class="mdl-dialog__title">Choose type</h4>
        <div class="mdl-dialog__content">
            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                <select id="subscription" class="mdl-textfield__input">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                </select>
                <label class="mdl-textfield__label" for="subscription">Subscription type</label>
            </div>
        </div>
        <div class="mdl-dialog__actions">

            <button type="button" class="mdl-button close">Close</button>
            <button type="button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect" id="subscribe">Subscribe!</button>
        </div>
    </dialog>
</div>
<script src="{{ asset('public/js/jquery-3.2.1.min.js') }}"></script>
<script src="{{ asset('public/bootstrap/js/bootstrap.min.js') }}"></script>
<script src="{{ asset('public/mdl/material.min.js') }}"></script>
<script src="{{ asset('public/js/logic.js') }}"></script>
{% block javascript %}
    <script>
        function onSelectChange() {
            var ind = document.getElementById('sorting').options.selectedIndex;
            switch (ind) {
                case 0:
                    window.location.href = "{{ path('sorting-params', {'isAscending': 1, 'isOrderByDate': 1}) }}";
                    break;
                case 1:
                    window.location.href = "{{ path('sorting-params', {'isAscending': 0, 'isOrderByDate':1}) }}";
                    break;
                case 2:
                    window.location.href = "{{ path('sorting-params', {'isAscending': 1, 'isOrderByDate':0}) }}";
                    break;
                case 3:
                    window.location.href = "{{ path('sorting-params', {'isAscending': 0, 'isOrderByDate':0}) }}";
                    break;
            }
        }
    </script>
{% endblock %}
</body>
</html>